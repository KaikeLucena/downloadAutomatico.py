import os
import pandas as pd
from selenium.webdriver.common.keys import Keys
from selenium import webdriver



# Define o caminho do driver do Chrome
chrome_driver_path = "/caminho/para/o/driver/chromedriver.exe"

# Cria uma instância do ChromeDriver
driver = webdriver.Chrome(chrome_driver_path)

# Abrir o arquivo LINKS RELATORIOS.xlsx e acessar a célula B1
df = pd.read_excel('LINKS RELATORIOS.xlsx', usecols="B", skiprows=0, nrows=1)
link = df.iloc[0][0]

# Abrir o link na barra de URL do navegador
os.startfile(link)

# Localizar o elemento da aba "Relatórios" e clicar nele
aba_relatorios = driver.find_element_by_xpath("//button[@id='aba-relatorios']")
aba_relatorios.click()

# Localizar o elemento da pasta "7.1-B.i" e clicar nele
pasta_bi = driver.find_element_by_xpath("//a[@id='pasta-bi']")
pasta_bi.click()

#############################3333

import os
import pandas as pd
import urllib

from selenium import webdriver


# Abrir o arquivo LINKS RELATORIOS.xlsx e acessar a célula B1
df = pd.read_excel('LINKS RELATORIOS.xlsx', usecols="B", skiprows=0, nrows=1)
link = df.iloc[0][0]

# Inicializar o webdriver e abrir o link
driver = webdriver.Chrome()
driver.get(link)

# Clicar no botão "Relatórios"
relatorios_btn = driver.find_element_by_xpath("//button[contains(text(),'Relatórios')]")
relatorios_btn.click()

# Clicar no botão da pasta "7.1-B.i"
b_i_folder_btn = driver.find_element_by_xpath("//a[contains(text(),'7.1-B.i')]")
b_i_folder_btn.click()

# Encontrar o link do arquivo dentro da página da pasta
file_link = driver.find_element_by_xpath("//a[contains(text(),'arquivo.zip')]").get_attribute('href')

# Baixar o arquivo diretamente pelo URL
urllib.request.urlretrieve(file_link, 'nome_do_arquivo.zip')

# Fechar o navegador
driver.quit()




 ###############################
  selenium biblioteca que acessa o navegador e clica em botões.
  colocar crhome drive na mesma pasta em que o python está instalado.
  
  #################################
  xpath do botao relatorios
  //*[@id="sub-header-button-item"]/li/button
  
  xpath do botao 7.1-Bi
  //*[@id="pipe_placeholder"]/div[2]/div/div[1]/main/div[2]/div[9]/div/a
  
  xpath do botão exportar 
  //*[@id="pipe_placeholder"]/div[2]/div/div[1]/div[2]/div[1]/div[1]/div[3]/div/div/button/div/div/svg
  
  xpath do botão download
  /html/body/div[13]/div/div[2]/footer/button[2]
  
  sempre colocar aspas simples entre os parenteses, pois alguns codigo xpath tem aspas duplas
 ############################### 
 
 
 
 
